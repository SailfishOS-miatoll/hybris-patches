From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Simonas Leleiva <simonas.leleiva@meramo.co.uk>
Date: Sat, 22 Aug 2015 12:03:42 +0100
Subject: [PATCH] (hybris) reach main init state

Change-Id: I471f48afaebf91c92f0d2a7bd3a24c5d1fa58ecd
---
 rootdir/init.rc | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/rootdir/init.rc b/rootdir/init.rc
index c629894be85588285ed4a2a5deff112a1cae8f61..31a9e78c460d0335e2951527274f25af0fa51145 100644
--- a/rootdir/init.rc
+++ b/rootdir/init.rc
@@ -550,7 +550,7 @@ on late-init
 
 on early-fs
     # Once metadata has been mounted, we'll need vold to deal with userdata checkpointing
-    start vold
+    #start vold
 
 on post-fs
     exec - system system -- /system/bin/vdc checkpoint markBootAttempt
@@ -675,6 +675,8 @@ on post-fs-data
     restorecon /data
 
     # Make sure we have the device encryption key.
+    # hybris continue bootup properly
+    setprop vold.decrypt trigger_restart_min_framework
     installkey /data
 
     # Start bootcharting as soon as possible after the data partition is
@@ -1307,7 +1309,7 @@ on userspace-reboot-fs-remount
   # Make sure that vold is running.
   # This is mostly a precaution measure in case vold for some reason wasn't running when
   # userspace reboot was initiated.
-  start vold
+  #start vold
   exec - system system -- /system/bin/vdc checkpoint resetCheckpoint
   exec - system system -- /system/bin/vdc checkpoint markBootAttempt
   # Unmount /data_mirror mounts in the reverse order of corresponding mounts.
